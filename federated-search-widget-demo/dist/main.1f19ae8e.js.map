{"version":3,"sources":["webpack://RecentSearches/webpack/universalModuleDefinition","webpack://RecentSearches/webpack/bootstrap","webpack://RecentSearches/lib/MemoryStorage.ts","webpack://RecentSearches/lib/SafeLocalStorage.ts","webpack://RecentSearches/lib/utils/score.ts","webpack://RecentSearches/lib/utils/string.ts","webpack://RecentSearches/lib/index.ts","federated-search-widget/federated-search-widget.js","main.js","node_modules/parcel/src/builtins/hmr-runtime.js"],"names":["MemoryStorage","config","DATA","KEY","DEFAULT_VALUE","data","key","defaultValue","DEFAULT_STORAGE_KEY","isLocalStorageSupported","localStorage","setItem","removeItem","error","safeDataParse","JSON","parse","e","SafeLocalStorage","getItem","items","stringify","NewSafeLocalStorage","computeMatchScore","search","query","rankBy","ttl","normalizedQuery","String","indexOf","Math","log10","Date","getTime","timestamp","matchDistance","timeDelta","log2","proximity","isBlank","str","test","isValidQuery","RecentSearches","RECENT_SEARCHES","matchedSearches","map","score","RANKING","TTL","filter","filterScoredResults","sort","sortScoredResults","existingQueryIndex","findIndex","searchEntry","splice","unshift","slice","LIMIT","STORAGE","a","b","currentTimestamp","limit","LocalStorage","namespace","initializeStorageData","ranking","filterUniques","suggestions","uniques","reduce","acc","suggestion","Object","values","renderSearchBoxContainer","placeholder","value","suppressComboBoxFocus","event","isKey","sanitizeQuery","replace","code","name","which","keyCode","validateMandatoryColumnOptions","column","COLUMN_TYPES","MANDATORY_PARAMS","errors","forEach","param","push","Error","type","message","join","validateQuerySuggestionsColumnOptions","itemRenderer","validateSearchColumnOptions","validateFacetColumnOptions","facets","length","facetTitleRenderer","COLUMN_TYPE_VALIDATORS","Search","QuerySuggestions","Facets","initializeIndices","columns","client","indices","indexName","initIndex","initializeSearchInsights","appId","apiKey","t","n","s","i","c","AlgoliaAnalyticsObject","aa","queue","arguments","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","document","enrichHitsWithClickAnalyticsData","hits","queryID","hit","index","__queryID","__position","renderColumns","resultsContainer","DEFAULT_TITLE","title","DEFAULT_RESULTS","columnNode","titleHTML","titleRenderer","resultsHTML","resultsTemplate","innerHTML","append","lastChild","facet","innerColumn","facetTitleHTML","appendChild","FederatedSearchWidget","options","hijackedKey","preventDefault","currentSelectedElement","querySelector","dispatchEvent","Event","helper","setQuery","searchBoxInput","style","display","Array","from","querySelectorAll","firstSuggestion","setAttribute","updateActiveDescendantA11y","id","nextSelectedElement","removeAttribute","lastSuggestion","currentIndex","clear","instantSearchOptions","clearButton","updateExpandedA11y","hitsPerPage","then","response","renderFacets","clickAnalytics","renderQuerySuggestions","maxSavedSearchesPerQuery","renderSearchHits","expanded","searchBoxContainer","getAttribute","activeDescendantID","mandatoryErrors","concat","customColumnErrors","widgetOptions","container","appID","closeOnBlur","openOnFocus","querySuggestionOptions","find","recentSearchesEnabled","columnsMetaData","algoliasearch","widgetContainer","state","some","addEventListener","onKeyBoardNavigation","currentTarget","contains","target","facetsNode","childNodes","noResultsRenderer","entries","count","category","element","afterItemRenderer","recentSearches","searches","getRecentSearches","__recent__","_highlightResult","objectID","renderQuerySuggestionWithCategory","counter","sourceIndex","bestMatchedFacet","exact_matches","arr","round","numberWithCommas","toString","virutalRefinementList","instantsearch","connectors","connectRefinementList","searchClient","routing","addWidget","widgets","configure","currentRefinements","templates","empty","item","largeImage","brand","price","setRecentSearch","stopPropagation","eventName","objectIDs","positions","noResultLabel","facetCategory","nextState","addDisjunctiveFacetRefinement","location","href","createURL","pagination","stats","refinementList","attribute","showMore","searchable","searchablePlaceholder","start","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","console","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","stack","overlay","createErrorOverlay","body","getElementById","remove","stackTrace","innerText","getParents","modules","parents","k","d","dep","isArray","Function","deps","cached","cache","cb"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"RecentSearches\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RecentSearches\"] = factory();\n\telse\n\t\troot[\"RecentSearches\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import {\n  DEFAULT_STORAGE_KEY,\n  ISafeLocalStorage,\n  ISafeLocalStorageConfig\n} from \"./SafeLocalStorage\";\n\ninterface IMemoryStorage<T> extends ISafeLocalStorage<T> {\n  readonly DATA: { [key: string]: T };\n}\n\nclass MemoryStorage<T> implements IMemoryStorage<T> {\n  public readonly DATA: { [key: string]: T } = {};\n  private readonly KEY: string;\n  private readonly DEFAULT_VALUE: T;\n\n  constructor(config: ISafeLocalStorageConfig<T>) {\n    const { key, defaultValue } = config;\n\n    this.DATA = {};\n    this.KEY = key || DEFAULT_STORAGE_KEY;\n    this.DEFAULT_VALUE = defaultValue;\n  }\n\n  public getItem = (): T => this.DATA[this.KEY] || this.DEFAULT_VALUE;\n  public setItem = (data: T): boolean => {\n    this.DATA[this.KEY] = data;\n    return true;\n  };\n}\n\nexport default MemoryStorage;\n","import MemoryStorage from \"./MemoryStorage\";\n\nexport const DEFAULT_STORAGE_KEY = \"__RECENT_SEARCHES__\";\nexport const isLocalStorageSupported = (): boolean => {\n  const key = \"__TEST__KEY__\";\n\n  try {\n    localStorage.setItem(key, \"\");\n    localStorage.removeItem(key);\n    return true;\n  } catch (error) {\n    return false;\n  }\n};\n\nexport const safeDataParse = <T>(data: string | null, defaultValue: T): T => {\n  if (!data) {\n    return defaultValue;\n  }\n\n  try {\n    return JSON.parse(data);\n  } catch (e) {\n    return defaultValue;\n  }\n};\n\nexport interface ISafeLocalStorageConfig<T> {\n  defaultValue: T;\n  key?: string;\n  limit?: number;\n}\n\nexport interface ISafeLocalStorage<T> {\n  getItem: () => T;\n  setItem: (item: T) => boolean;\n}\n\nexport class SafeLocalStorage<T> implements ISafeLocalStorage<T> {\n  private readonly KEY: string;\n  private readonly DEFAULT_VALUE: T;\n\n  constructor(config: ISafeLocalStorageConfig<T>) {\n    const { key, defaultValue } = config;\n\n    this.KEY = key || DEFAULT_STORAGE_KEY;\n    this.DEFAULT_VALUE = defaultValue;\n  }\n\n  public getItem = (): T => {\n    const data = localStorage.getItem(this.KEY);\n    return safeDataParse(data, this.DEFAULT_VALUE);\n  };\n\n  public setItem = (items: T): boolean => {\n    try {\n      localStorage.setItem(this.KEY, JSON.stringify(items));\n      return true;\n    } catch (e) {\n      return false;\n    }\n  };\n}\n\nconst NewSafeLocalStorage = <T>(\n  config: ISafeLocalStorageConfig<T>\n): SafeLocalStorage<T> | MemoryStorage<T> => {\n  if (!isLocalStorageSupported()) {\n    return new MemoryStorage(config);\n  }\n\n  return new SafeLocalStorage(config);\n};\n\nexport default NewSafeLocalStorage;\n","import { ISearch, RankingStrategy } from \"./../\";\n\nconst computeMatchScore = (\n  search: ISearch,\n  query: string | number,\n  rankBy: RankingStrategy,\n  ttl: number\n): number => {\n  const normalizedQuery = String(query);\n\n  switch (rankBy) {\n    case \"PROXIMITY\":\n      return search.query.indexOf(normalizedQuery);\n    case \"TIME\":\n      return Math.log10(new Date().getTime() - search.timestamp);\n    default:\n      const matchDistance = search.query.indexOf(normalizedQuery);\n      const timeDelta = Math.log2(\n        (new Date().getTime() - search.timestamp) / ttl + 1\n      );\n      const proximity = Math.log2(matchDistance + 1) || 1;\n\n      if (matchDistance === -1) {\n        return matchDistance;\n      }\n\n      return (0.01 + 0.49 * proximity + 0.49 * timeDelta) / 1;\n  }\n};\n\nexport default computeMatchScore;\n","const isBlank = (str: string = \"\"): boolean => {\n  return /^\\s*$/.test(str);\n};\n\nconst isValidQuery = (query?: any): query is string | number => {\n  return (\n    (typeof query === \"string\" && !isBlank(query)) || typeof query === \"number\"\n  );\n};\n\nexport default isValidQuery;\n","import MemoryStorage from \"./MemoryStorage\";\nimport LocalStorage, { SafeLocalStorage } from \"./SafeLocalStorage\";\n\nimport computeMatchScore from \"./utils/score\";\nimport isValidQuery from \"./utils/string\";\n\nexport interface ISearch {\n  query: string;\n  timestamp: number;\n  data?: {\n    [key: string]: string;\n  };\n}\n\nexport type ScoredSearch = ISearch & {\n  score: number;\n};\n\nexport type RankingStrategy = \"PROXIMITY\" | \"TIME\" | \"PROXIMITY_AND_TIME\";\n\nexport interface IRecentSearchesConfig {\n  ttl?: number;\n  limit?: number;\n  namespace?: string;\n  ranking?: RankingStrategy;\n}\n\nexport type RecentSearchesStorage =\n  | SafeLocalStorage<ISearch[]>\n  | MemoryStorage<ISearch[]>;\n\nexport class RecentSearches {\n  private readonly TTL: number;\n  private readonly LIMIT: number;\n  private readonly STORAGE: RecentSearchesStorage;\n  private readonly RANKING: RankingStrategy;\n\n  private RECENT_SEARCHES: ISearch[] = [];\n\n  constructor(config: IRecentSearchesConfig = {}) {\n    this.TTL = config.ttl || 1000 * 60 * 60 * 24;\n    this.LIMIT = config.limit || 50;\n    this.STORAGE = LocalStorage<ISearch[]>({\n      defaultValue: [],\n      key: config.namespace\n    });\n    this.RECENT_SEARCHES = this.initializeStorageData();\n    this.RANKING = config.ranking || \"PROXIMITY_AND_TIME\";\n  }\n\n  /**\n   * Retrieve recent searches for a given query.\n   * If no query is passed, returns all recent searches\n   *\n   * @param  {string} query?\n   * @returns Search[]\n   */\n  public getRecentSearches = (query?: string | number): ISearch[] => {\n    if (!isValidQuery(query)) {\n      return this.RECENT_SEARCHES;\n    }\n\n    const matchedSearches = this.RECENT_SEARCHES.map(search => {\n      const score = computeMatchScore(search, query, this.RANKING, this.TTL);\n\n      return {\n        data: search.data,\n        query: search.query,\n        score,\n        timestamp: search.timestamp\n      };\n    })\n      .filter(this.filterScoredResults)\n      .sort(this.sortScoredResults)\n      .map(search => ({\n        data: search.data,\n        query: search.query,\n        timestamp: search.timestamp\n      }));\n\n    return matchedSearches;\n  };\n\n  /**\n   * Set a recent search and data related to it.\n   *\n   * @param  {string} query\n   * @param  {object} data?\n   * @returns Search[]\n   */\n  public setRecentSearch = (\n    query: string | number,\n    data?: ISearch[\"data\"]\n  ): ISearch[] => {\n    if (!isValidQuery(query)) {\n      return this.RECENT_SEARCHES;\n    }\n\n    const search: ISearch = {\n      data,\n      query: String(query),\n      timestamp: new Date().getTime()\n    };\n\n    const existingQueryIndex = this.RECENT_SEARCHES.findIndex(\n      searchEntry => searchEntry.query === query\n    );\n\n    if (existingQueryIndex > -1) {\n      this.RECENT_SEARCHES.splice(existingQueryIndex, 1);\n    }\n\n    this.RECENT_SEARCHES.unshift(search);\n    this.RECENT_SEARCHES = this.RECENT_SEARCHES.slice(0, this.LIMIT);\n    this.STORAGE.setItem(this.RECENT_SEARCHES);\n\n    return this.RECENT_SEARCHES;\n  };\n\n  private filterScoredResults = (search: ScoredSearch): boolean => {\n    if (this.RANKING === \"TIME\") {\n      return true;\n    }\n\n    return search.score > -1;\n  };\n\n  private sortScoredResults = (a: ScoredSearch, b: ScoredSearch): number => {\n    return a.score - b.score;\n  };\n\n  private initializeStorageData = (): ISearch[] => {\n    const currentTimestamp = new Date().getTime();\n\n    const items = this.STORAGE.getItem()\n      .filter(search => search.timestamp + this.TTL >= currentTimestamp)\n      .slice(0, this.LIMIT);\n\n    this.STORAGE.setItem(items);\n    this.RECENT_SEARCHES = items;\n    return items;\n  };\n}\n\nexport default RecentSearches;\n","import RecentSearches from \"recent-searches\"\n\nconst filterUniques = (suggestions, query) => {\n  const uniques = suggestions.reduce((acc, suggestion) => {\n    if (acc[suggestion.query] || query === suggestion.query) return acc;\n    acc[suggestion.query] = suggestion;\n    return acc;\n  }, {});\n\n  return Object.values(uniques);\n};\n\nconst renderSearchBoxContainer = (placeholder, value) => `\n  <div id=\"searchbox\">\n    <div \n      id=\"search-box-container\"\n      role=\"combobox\"\n      aria-expanded=\"false\"\n      aria-owns=\"search-results-container\"\n      aria-haspopup=\"grid\"\n      >\n      <input \n        id=\"search-box-input\"\n        autocomplete=\"off\"\n        aria-autocomplete=\"list\"\n        aria-controls=\"search-results-container\"\n        placeholder=\"${placeholder}\"\n        value=\"${value}\"\n        type=\"text\"\n      >\n    </div>\n    <div id=\"clear-input\"><i class=\"fas fa-times\"></i></div>\n    <div \n      style=\"display: none\"\n      id=\"search-results-container\"\n      role=\"grid\">\n    </div>\n  </div>\n`;\n\nconst suppressComboBoxFocus = event => {\n  if (isKey(event, 40, \"ArrowDown\")) return \"ArrowDown\";\n  if (isKey(event, 38, \"ArrowUp\")) return \"ArrowUp\";\n  if (isKey(event, 13, \"Enter\")) return \"Enter\";\n  if (isKey(event, 27, \"Escape\")) return \"Escape\";\n  return null;\n};\nconst sanitizeQuery = query => query.replace(/\\s+/gm, \"\");\nconst isKey = (event, code, name) =>\n  event.which === code || event.keyCode === code || event.key === name;\n\nconst validateMandatoryColumnOptions = column => {\n  const COLUMN_TYPES = [\"QuerySuggestions\", \"Facets\", \"Search\"];\n  const MANDATORY_PARAMS = [\"indexName\", \"type\", \"noResultsRenderer\"];\n\n  const errors = [];\n\n  MANDATORY_PARAMS.forEach(param => {\n    if (!column[param]) {\n      errors.push(new Error(`${param} parameter was not provided.`));\n    }\n  });\n\n  if (COLUMN_TYPES.indexOf(column.type) === -1) {\n    const message = `Column has unknown type ${\n      column.type\n    }. Valid column types are ${COLUMN_TYPES.join(\", \")}`;\n\n    errors.push(new Error(message));\n  }\n\n  return errors;\n};\n\nconst validateQuerySuggestionsColumnOptions = column => {\n  const errors = [];\n  if (typeof column.itemRenderer !== \"function\") {\n    errors.push(\n      new Error(\n        \"Search column requires itemRenderer function param that returns the string you want to render\"\n      )\n    );\n  }\n\n  return errors;\n};\n\nconst validateSearchColumnOptions = column => {\n  const errors = [];\n  if (typeof column.itemRenderer !== \"function\") {\n    errors.push(\n      new Error(\n        \"Search column requires itemRenderer function param that returns the string you want to render\"\n      )\n    );\n  }\n\n  return errors;\n};\n\nconst validateFacetColumnOptions = column => {\n  const errors = [];\n  if (!column.facets || !column.facets.length) {\n    errors.push(\n      new Error(\n        \"Facets column requires you to specifiy a facets array that represents the facets you want displayed. Example: ['brand', 'category']\"\n      )\n    );\n  }\n\n  if (typeof column.itemRenderer !== \"function\") {\n    errors.push(\n      new Error(\n        \"Search column requires itemRenderer function param that returns the string you want to render\"\n      )\n    );\n  }\n\n  if (typeof column.facetTitleRenderer !== \"function\") {\n    errors.push(\n      new Error(\n        \"Facets column requires facetTitleRenderer function which returns the string you want to render. Example: function(facet){return 'Searched in ' + facet }\"\n      )\n    );\n  }\n\n  return errors;\n};\n\nconst COLUMN_TYPE_VALIDATORS = {\n  Search: validateSearchColumnOptions,\n  QuerySuggestions: validateQuerySuggestionsColumnOptions,\n  Facets: validateFacetColumnOptions\n};\n\nconst initializeIndices = (columns, client) => {\n  // Initialize a map [indexName: string]: AlgoliaIndex\n  return columns.reduce((indices, column) => {\n    if (indices[column.indexName]) return indices;\n    indices[column.indexName] = client.initIndex(column.indexName);\n    return indices;\n  }, {});\n};\n\nconst initializeSearchInsights = (appId, apiKey) => {\n  !(function(e, a, t, n, s, i, c) {\n    (e.AlgoliaAnalyticsObject = s),\n      (e.aa =\n        e.aa ||\n        function() {\n          (e.aa.queue = e.aa.queue || []).push(arguments);\n        }),\n      (i = a.createElement(t)),\n      (c = a.getElementsByTagName(t)[0]),\n      (i.async = 1),\n      (i.src = \"https://cdn.jsdelivr.net/npm/search-insights@1.0.0\"),\n      c.parentNode.insertBefore(i, c);\n  })(window, document, \"script\", 0, \"aa\");\n\n  window.aa(\"init\", {\n    appId,\n    apiKey\n  });\n\n  return true;\n};\n\nconst enrichHitsWithClickAnalyticsData = (hits, queryID) => {\n  return hits.map((hit, index) => ({\n    ...hit,\n    __queryID: queryID,\n    __position: index + 1\n  }));\n};\n\nconst renderColumns = (resultsContainer, columns) => {\n  // This has the side effect of enriching the column with it's respective\n  // container node. This way we can avoid relying on custom id's\n  const DEFAULT_TITLE = title => `<h3 class=\"column-title\">${title}</h3>`;\n  const DEFAULT_RESULTS = () => `<ul></ul>`;\n\n  return columns.map(column => {\n    const columnNode = document.createElement(\"div\");\n\n    const titleHTML =\n      typeof column.titleRenderer === \"function\"\n        ? column.titleRenderer()\n        : DEFAULT_TITLE(column.title);\n\n    const resultsHTML =\n      typeof column.resultsTemplate === \"function\"\n        ? column.resultsTemplate()\n        : DEFAULT_RESULTS();\n\n    if (column.type !== \"Facets\") {\n      columnNode.innerHTML = titleHTML + resultsHTML;\n      resultsContainer.append(columnNode);\n\n      return {\n        ...column,\n        limit: column.limit || 5,\n        columnNode: columnNode.lastChild\n      };\n    } else {\n      column.facets.forEach((facet, index) => {\n        const innerColumn = document.createElement(\"div\");\n        const facetTitleHTML = column.facetTitleRenderer(facet);\n        const resultsHTML =\n          typeof column.resultsTemplate === \"function\"\n            ? column.resultsTemplate([])\n            : DEFAULT_RESULTS();\n\n        innerColumn.innerHTML = facetTitleHTML + resultsHTML;\n        columnNode.appendChild(innerColumn);\n      });\n\n      resultsContainer.append(columnNode);\n\n      return {\n        ...column,\n        limit: column.limit || 5,\n        columnNode: columnNode\n      };\n    }\n  });\n};\n\nclass FederatedSearchWidget {\n  constructor(options) {\n    const mandatoryErrors = options.columns.reduce((acc, column) => {\n      return acc.concat(validateMandatoryColumnOptions(column));\n    }, []);\n\n    if (mandatoryErrors.length > 0) throw mandatoryErrors;\n\n    const customColumnErrors = options.columns.reduce((acc, column) => {\n      return acc.concat(COLUMN_TYPE_VALIDATORS[column.type](column));\n    }, []);\n\n    if (customColumnErrors.length > 0) throw customColumnErrors;\n\n    this.widgetOptions = {\n      container: options.container,\n      appID: options.appID,\n      apiKey: options.apiKey,\n      placeholder: options.placeholder || \"Search by Algolia\",\n      closeOnBlur:\n        typeof options.closeOnBlur !== \"undefined\" ? options.closeOnBlur : true,\n      openOnFocus:\n        typeof options.openOnFocus !== \"undefined\" ? options.openOnFocus : false\n    };\n\n    const querySuggestionOptions = options.columns.find(\n      c => c.type === \"QuerySuggestions\"\n    );\n\n    this.maxSavedSearchesPerQuery = options.maxSavedSearchesPerQuery || 4;\n    this.recentSearchesEnabled = options.recentSearchesEnabled || false;\n    if (this.recentSearchesEnabled) {\n      this.RecentSearches = new RecentSearches({\n        namespace: querySuggestionOptions[\"indexName\"]\n      });\n    }\n\n    this.columnsMetaData = options.columns;\n\n    // DOM Element references\n    this.client = algoliasearch(\n      this.widgetOptions.appID,\n      this.widgetOptions.apiKey\n    );\n\n    this.indices = initializeIndices(this.columnsMetaData, this.client);\n  }\n\n  init(instantSearchOptions) {\n    this.helper = instantSearchOptions.helper;\n    this.widgetContainer = document.querySelector(this.widgetOptions.container);\n    this.widgetContainer.innerHTML = renderSearchBoxContainer(\n      this.widgetOptions.placeholder,\n      instantSearchOptions.helper.state.query\n    );\n\n    this.searchBoxContainer = this.widgetContainer.querySelector(\n      \"#search-box-container\"\n    );\n    this.searchBoxInput = this.widgetContainer.querySelector(\n      \"#search-box-input\"\n    );\n\n    this.clearButton = this.widgetContainer.querySelector(\"#clear-input\");\n    this.resultsContainer = this.widgetContainer.querySelector(\n      \"#search-results-container\"\n    );\n\n    if (this.columnsMetaData.some(column => column.clickAnalytics)) {\n      initializeSearchInsights(\n        this.widgetOptions.appID,\n        this.widgetOptions.apiKey\n      );\n    }\n\n    this.columns = renderColumns(this.resultsContainer, this.columnsMetaData);\n\n    this.searchBoxInput.addEventListener(\"keydown\", this.onKeyBoardNavigation);\n    this.searchBoxInput.addEventListener(\"input\", event => {\n      const query = event.currentTarget.value;\n\n      if (!query) {\n        this.clearButton.style.display = \"none\";\n        this.resultsContainer.style.display = \"none\";\n        this.updateExpandedA11y(false);\n        return;\n      }\n\n      this.search(query, instantSearchOptions);\n    });\n\n    if (this.widgetOptions.openOnFocus) {\n      this.searchBoxInput.addEventListener(\"focus\", event => {\n        const query = event.currentTarget.value;\n        this.search(query, instantSearchOptions);\n      });\n    }\n\n    if (this.widgetOptions.closeOnBlur) {\n      document.addEventListener(\"click\", event => {\n        if (this.widgetContainer.contains(event.target)) {\n          // Click has happened inside the widget\n          return;\n        }\n        this.clearButton.style.display = \"none\";\n        this.resultsContainer.style.display = \"none\";\n      });\n    }\n\n    // Clear button\n    this.clearButton.addEventListener(\"click\", e => {\n      this.searchBoxInput.value = \"\";\n      this.clearButton.style.display = \"none\";\n      const event = new Event(\"input\");\n      this.searchBoxInput.dispatchEvent(event);\n    });\n  }\n\n  // Keyboard navigation\n  onKeyBoardNavigation = event => {\n    const hijackedKey = suppressComboBoxFocus(event);\n    // Keep the focus inside the textbox\n    if (hijackedKey) event.preventDefault();\n\n    if (hijackedKey === \"Enter\") {\n      const currentSelectedElement = this.resultsContainer.querySelector(\n        '[aria-selected=\"true\"]'\n      );\n\n      if (currentSelectedElement) {\n        return currentSelectedElement.dispatchEvent(new Event(\"click\"));\n      }\n\n      this.helper.setQuery(this.searchBoxInput.value).search();\n      this.resultsContainer.style.display = \"none\";\n    }\n\n    if (hijackedKey === \"ArrowDown\") {\n      // Handle ArrowDown\n      const currentSelectedElement = this.resultsContainer.querySelector(\n        '[aria-selected=\"true\"]'\n      );\n\n      const suggestions = Array.from(\n        this.resultsContainer.querySelectorAll(\"li\")\n      );\n      if (!suggestions.length) return;\n\n      // Set first element to selected\n      if (!currentSelectedElement) {\n        const firstSuggestion = suggestions[0];\n        firstSuggestion.setAttribute(\"aria-selected\", true);\n        this.updateActiveDescendantA11y(firstSuggestion.id);\n        return;\n      }\n\n      // Set next element to selected\n      const nextSelectedElement =\n        suggestions[\n          (suggestions.indexOf(currentSelectedElement) + 1) % suggestions.length\n        ];\n\n      currentSelectedElement.removeAttribute(\"aria-selected\");\n      nextSelectedElement.setAttribute(\"aria-selected\", true);\n      this.updateActiveDescendantA11y(nextSelectedElement.id);\n    }\n\n    // Handle ArrowUp\n    if (hijackedKey === \"ArrowUp\") {\n      const currentSelectedElement = this.resultsContainer.querySelector(\n        '[aria-selected=\"true\"]'\n      );\n\n      const suggestions = Array.from(\n        this.resultsContainer.querySelectorAll(\"li\")\n      );\n      if (!suggestions.length) return;\n\n      // Set last element to selected\n      if (!currentSelectedElement) {\n        const lastSuggestion = suggestions[suggestions.length - 1];\n        lastSuggestion.setAttribute(\"aria-selected\", true);\n        this.updateActiveDescendantA11y(lastSuggestion.id);\n        return;\n      }\n\n      // Set previous element to selected\n      const currentIndex = suggestions.indexOf(currentSelectedElement) - 1;\n      const nextSelectedElement =\n        suggestions[\n          currentIndex === -1\n            ? suggestions.length - 1\n            : currentIndex % suggestions.length\n        ];\n\n      currentSelectedElement.removeAttribute(\"aria-selected\");\n      nextSelectedElement.setAttribute(\"aria-selected\", true);\n      this.updateActiveDescendantA11y(nextSelectedElement.id);\n    }\n\n    if (hijackedKey === \"Escape\") {\n      this.clear();\n      this.updateActiveDescendantA11y();\n    }\n  };\n\n  search = (query, instantSearchOptions) => {\n    this.clearButton.style.display = \"block\";\n    this.resultsContainer.style.display = \"\";\n    this.updateExpandedA11y(true);\n\n    // Perfom a search for each index\n    this.columns.forEach(column => {\n      const index = this.indices[column.indexName];\n\n      switch (column.type) {\n        case \"Facets\":\n          index\n            .search({\n              query,\n              hitsPerPage: 1,\n              facets: column.facets\n            })\n            .then(response => {\n              renderFacets(column, response, query, instantSearchOptions);\n              return response;\n            });\n          break;\n        case \"QuerySuggestions\":\n          index\n            .search({\n              query,\n              hitsPerPage: column.limit,\n              clickAnalytics: column.clickAnalytics\n            })\n            .then(response => {\n              renderQuerySuggestions(\n                column,\n                response,\n                query,\n                instantSearchOptions,\n                this.RecentSearches,\n                this.maxSavedSearchesPerQuery\n              );\n              return response;\n            });\n          break;\n        case \"Search\":\n          index\n            .search({\n              query,\n              hitsPerPage: column.limit,\n              clickAnalytics: column.clickAnalytics\n            })\n            .then(response => {\n              renderSearchHits(column, response, query, instantSearchOptions);\n              return response;\n            });\n          break;\n      }\n    });\n  };\n\n  updateExpandedA11y = expanded => {\n    if (\n      this.searchBoxContainer.getAttribute(\"aria-expanded\") !== String(expanded)\n    ) {\n      this.searchBoxContainer.setAttribute(\"aria-expanded\", expanded);\n    }\n  };\n\n  updateActiveDescendantA11y = activeDescendantID => {\n    if (\n      activeDescendantID &&\n      this.searchBoxInput.getAttribute(\"aria-activedescendant\") !==\n        String(activeDescendantID)\n    ) {\n      return this.searchBoxInput.setAttribute(\n        \"aria-activedescendant\",\n        activeDescendantID\n      );\n    }\n    this.searchBoxInput.removeAttribute(\"aria-activedescendant\");\n  };\n\n  clear = () => {\n    this.clearButton.style.display = \"none\";\n    this.resultsContainer.style.display = \"none\";\n  };\n}\n\nconst renderFacets = (column, response, query, instantSearchOptions) => {\n  column.facets.forEach((facet, index) => {\n    const facetsNode = column.columnNode.childNodes[index].lastChild;\n    facetsNode.innerHTML = \"\";\n\n    if (!response.facets[facet]) {\n      facetsNode.innerHTML = column.noResultsRenderer(query, response);\n      return;\n    }\n\n    Object.entries(response.facets[facet])\n      .slice(0, column.limit)\n      .forEach(([value, count]) => {\n        const hit = {\n          name: value,\n          category: facet,\n          count\n        };\n        const element = document.createElement(\"li\");\n        // ID is required to manage aria-activedescendant\n        element.id = `${facet}-${sanitizeQuery(value)}-${index}`;\n\n        element.innerHTML = column.itemRenderer(hit);\n        facetsNode.appendChild(element);\n\n        if (typeof column.afterItemRenderer === \"function\") {\n          column.afterItemRenderer(\n            element,\n            hit,\n            response,\n            instantSearchOptions\n          );\n        }\n      });\n  });\n};\n\nconst renderQuerySuggestions = (\n  column,\n  response,\n  query,\n  instantSearchOptions,\n  recentSearches,\n  maxSavedSearchesPerQuery\n) => {\n  column.columnNode.innerHTML = \"\";\n\n  let hits;\n\n  if (recentSearches) {\n    const searches = recentSearches\n      .getRecentSearches(query)\n      .slice(0, maxSavedSearchesPerQuery)\n      .map(suggestion => ({ ...suggestion.data, __recent__: true }));\n\n    hits = searches.concat(response.hits);\n  } else {\n    hits = response.hits;\n  }\n\n  if (!hits.length) {\n    column.columnNode.innerHTML = column.noResultsRenderer(query, response);\n    return;\n  }\n\n  hits.forEach((hit, index) => {\n    const element = document.createElement(\"li\");\n    // ID is required to manage aria-activedescendant\n    element.id = `${sanitizeQuery(hit.query)}-${index}`;\n    element.innerHTML =\n      typeof column.itemRenderer === \"function\"\n        ? column.itemRenderer(hit, index, response)\n        : hit._highlightResult.query.value;\n\n    column.columnNode.append(element);\n    if (typeof column.afterItemRenderer === \"function\") {\n      column.afterItemRenderer(\n        element,\n        hit,\n        response,\n        instantSearchOptions,\n        recentSearches\n      );\n    }\n  });\n};\n\nconst renderSearchHits = (column, response, query, instantSearchOptions) => {\n  const hits = response.queryID\n    ? enrichHitsWithClickAnalyticsData(response.hits, response.queryID)\n    : response.hits;\n\n  column.columnNode.innerHTML = \"\";\n\n  if (!hits.length) {\n    column.columnNode.innerHTML = column.noResultsRenderer(query, response);\n    return;\n  }\n\n  hits.forEach((hit, index) => {\n    const element = document.createElement(\"li\");\n    // ID is required to manage aria-activedescendant\n    element.id = `${sanitizeQuery(hit.objectID)}-${index}`;\n\n    element.innerHTML = column.itemRenderer(hit);\n    column.columnNode.append(element);\n\n    if (typeof column.afterItemRenderer === \"function\") {\n      column.afterItemRenderer(element, hit, response, instantSearchOptions);\n    }\n  });\n};\n\nexport default FederatedSearchWidget;\n","import FederatedSearchWidget from \"./federated-search-widget/federated-search-widget.js\";\n\nconst appID = \"932LAAGOT3\";\nconst apiKey = \"6a187532e8e703464da52c20555c37cf\";\n\nconst renderQuerySuggestionWithCategory = (\n  suggestion,\n  counter,\n  response,\n  sourceIndex\n) => {\n  if (!suggestion[sourceIndex]) {\n    return suggestion._highlightResult.query.value;\n  }\n\n  const bestMatchedFacet = Object.values(\n    suggestion[sourceIndex].facets.exact_matches\n  )\n    .reduce((acc, arr) => acc.concat(arr), [])\n    .sort((a, b) => {\n      if (a.count > b.count) return -1;\n      if (a.count < b.count) return 1;\n      return 0;\n    });\n\n  if (counter < Math.round(response.hits.length * 0.25)) {\n    return `\n        <div>\n          <i class=\"fas ${suggestion.__recent__ && \"fa-clock\"}\"></i>\n          <span class=\"inverted-highlight\">\n            ${suggestion._highlightResult.query.value}\n          </span>\n          <span class=\"in-facet\">\n            <i>\n              in ${bestMatchedFacet[0].value}\n            </i>\n          </span>\n        </div>\n      `;\n  } else {\n    return `\n      <div>\n        <i class=\"fas ${suggestion.__recent__ && \"fa-clock\"}\"></i>\n        <span class=\"inverted-highlight\">\n          ${suggestion._highlightResult.query.value}\n        </span>\n      </div>\n    `;\n  }\n};\n\nconst numberWithCommas = n =>\n  n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\nconst virutalRefinementList = instantsearch.connectors.connectRefinementList(\n  () => {}\n);\n\nconst search = instantsearch({\n  indexName: \"atis-prods\",\n  searchClient: algoliasearch(appID, apiKey),\n  routing: true // This option is mandatory to allow the createURL function to generate an URL.\n});\n\nsearch.addWidget(\n  instantsearch.widgets.configure({\n    hitsPerPage: 12\n  })\n);\n\nsearch.addWidget(\n  // Useful for debug purpose\n  instantsearch.widgets.currentRefinements({\n    container: \"#current-refinements\"\n  })\n);\n\nsearch.addWidget(\n  instantsearch.widgets.hits({\n    container: \"#hits\",\n    templates: {\n      empty: \"No results\",\n      item(hit) {\n        return `\n            <div class=\"item\">\n                <div class=\"centered\"><img src=\"${hit.largeImage}\" alt=\"\"></div>\n                <div class=\"centered\"><div class=\"add-to-cart\"><i class=\"fas fa-cart-plus\"></i> Add <span class=\"hide-mobile hide-tablet\">to Cart</span></div></div>\n                <div class=\"item-content\">\n                    <p class=\"brand\">${hit._highlightResult.brand &&\n                      hit._highlightResult.brand.value}</p>\n                    <p class=\"name\">${hit._highlightResult.title.value}</p>\n                </div>\n            </div>\n            <p class=\"price\">\\$${hit.price}</p>\n            <br>`;\n      }\n    }\n  })\n);\n\nsearch.addWidget(\n  new FederatedSearchWidget({\n    container: \"#search-box\",\n    appID,\n    apiKey,\n    placeholder: \"Search for products and brands\",\n    recentSearchesEnabled: false,\n    maxSavedSearchesPerQuery: 4,\n    closeOnBlur: true,\n    openOnFocus: true,\n    columns: [\n      {\n        type: \"QuerySuggestions\",\n        indexName: \"atis-prods_query_suggestions\",\n        clickAnalytics: true,\n        title: \"Suggestions\",\n        limit: 10,\n        noResultsRenderer: (query, response) =>\n          `No Matching Suggestion for ${query}`,\n        itemRenderer: (hit, counter, response) =>\n          renderQuerySuggestionWithCategory(\n            hit,\n            counter,\n            response,\n            \"atis-prods\"\n          ),\n        // itemRenderer: suggestion => `\n        //   <a href=\"http://localhost:3000/?q=${suggestion.query}\" target=\"_blank\">\n        //     ${suggestion._highlightResult.query.value}\n        //   </a>\n        // `\n        afterItemRenderer: (\n          element,\n          hit,\n          response,\n          options,\n          recentSearches\n        ) => {\n          element.addEventListener(\"click\", event => {\n            event.preventDefault();\n            if (recentSearches) {\n              recentSearches.setRecentSearch(hit.query, hit);\n            }\n\n            document.querySelector(\"#search-box-input\").value = hit.query;\n            options.helper.setQuery(hit.query).search();\n\n            document.querySelector(\"#search-results-container\").style.display =\n              \"none\";\n          });\n        }\n      },\n      {\n        type: \"Search\",\n        indexName: \"atis-prods\",\n        title: \"Products\",\n        clickAnalytics: true,\n        itemRenderer: hit => `\n          <div class='hit'>\n            <img src=\"${hit.largeImage}\" alt=\"\">\n            <div class=\"hit-info\">\n              <p class=\"hit-title\">${hit._highlightResult.title.value}</p>\n              <div class=\"hit-actions\">\n                <div>\n                  <span class=\"hit-price\">${hit.price}</span>\n                </div>\n                <div class=\"hit-buttons\">\n                  <button class=\"click-button\">View</button>\n                  <button class=\"buy-button\">Buy</button>\n                </div>\n              </div>\n            </div>\n          </div>`,\n        noResultsRenderer: (query, response) =>\n          `No Matching Products for query ${query}`,\n        afterItemRenderer: (element, hit, response, options) => {\n          element.addEventListener(\"click\", event => {\n            event.stopPropagation();\n            aa(\"clickedObjectIDsAfterSearch\", {\n              eventName: \"product_clicked\",\n              index: \"atis-prods\",\n              queryID: response.queryID,\n              objectIDs: [hit.objectID],\n              positions: [hit.__position]\n            });\n          });\n          // Example of sending a click event\n          element\n            .querySelector(\".click-button\")\n            .addEventListener(\"click\", event => {\n              event.stopPropagation();\n              aa(\"clickedObjectIDsAfterSearch\", {\n                eventName: \"product_clicked\",\n                index: \"atis-prods\",\n                queryID: response.queryID,\n                objectIDs: [hit.objectID],\n                positions: [hit.__position]\n              });\n            });\n          // Example of sending a conversion event\n          element\n            .querySelector(\".buy-button\")\n            .addEventListener(\"click\", event => {\n              event.stopPropagation();\n              aa(\"convertedObjectIDsAfterSearch\", {\n                eventName: \"product_clicked\",\n                index: \"atis-prods\",\n                queryID: response.queryID,\n                objectIDs: [hit.objectID]\n              });\n            });\n        }\n      },\n      {\n        type: \"Facets\",\n        indexName: \"atis-prods\",\n        noResultLabel: \"No result\",\n        facets: [\"categories\", \"brand\"],\n        clickAnalytics: true,\n        facetTitleRenderer: facet =>\n          `<h3 class=\"column-title\">${\n            facet === \"categories\" ? \"Categories\" : \"Brands\"\n          }</h3>`,\n        itemRenderer: (facet, facetCategory) => `\n          <span class=\"facet\">${facet.name}</span> ${numberWithCommas(\n          facet.count\n        )}\n        `,\n        noResultsRenderer: (query, response) =>\n          `No Matching Facet for query ${query}`,\n        afterItemRenderer: (element, hit, response, options) => {\n          // Add the facet refinement\n          element.addEventListener(\"click\", event => {\n            event.preventDefault();\n            const nextState = options.helper.state.addDisjunctiveFacetRefinement(\n              hit.category,\n              hit.name\n            );\n            window.location.href = options.createURL(nextState);\n          });\n        }\n      }\n    ]\n  })\n);\n\nsearch.addWidget(\n  instantsearch.widgets.pagination({\n    container: \"#pagination\"\n  })\n);\n\nsearch.addWidget(\n  instantsearch.widgets.stats({\n    container: \"#stats-container\"\n  })\n);\n\nsearch.addWidget(\n  instantsearch.widgets.refinementList({\n    container: \"#brand\",\n    attribute: \"brand\",\n    limit: 5,\n    showMore: true,\n    searchable: true,\n    searchablePlaceholder: \"Search our brands\"\n  })\n);\n\nsearch.addWidget(\n  // This widget is required otherwise we can't add the refinement to\n  // generate the URL with the refinement applied. The widget is headless\n  // it does not render anything. Note that for brand we don't have it because\n  // we already have a refinementList mounted on the page.\n  virutalRefinementList({\n    attribute: \"categories\" // Need to be all the facets that are currently not visible on the website\n  })\n);\n\nsearch.start();\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}